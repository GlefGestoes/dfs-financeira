<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Dados da Planilha</title>
  <style>
    table {
      border-collapse: collapse;
      width: 50%;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
    }
    th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>
  <h1>Dados da Planilha Google</h1>
  <table id="tabela-dados">
    <thead>
      <tr id="cabecalho"></tr>
    </thead>
    <tbody id="corpo-tabela"></tbody>
  </table>

<script>
  async function carregarDados() {
    const url = 'https://opensheet.elk.sh/1rL_fHQxLzoIEYoEvP9c04rbBTXsREkm4DtWA8zBWEvI/PÃ¡gina1';

    try {
      const resposta = await fetch(url);
      if (!resposta.ok) {
        throw new Error(`Erro ao acessar planilha: ${resposta.status}`);
      }

      const dados = await resposta.json();

      if (!Array.isArray(dados)) {
        throw new TypeError('Os dados recebidos nÃ£o estÃ£o em formato de array.');
      }

      const tabela = document.getElementById('tabela-dados');
      const cabecalho = document.getElementById('cabecalho');
      const corpo = document.getElementById('corpo-tabela');

      // ðŸ”„ Limpar antes de adicionar novamente
      cabecalho.innerHTML = '';
      corpo.innerHTML = '';

      // Gera o cabeÃ§alho dinamicamente
      const colunas = Object.keys(dados[0]);
      colunas.forEach(coluna => {
        const th = document.createElement('th');
        th.textContent = coluna;
        cabecalho.appendChild(th);
      });

      // Gera as linhas da tabela
      dados.forEach(linha => {
        const tr = document.createElement('tr');
        colunas.forEach(coluna => {
          const td = document.createElement('td');
          td.textContent = linha[coluna] || '';
          tr.appendChild(td);
        });
        corpo.appendChild(tr);
      });

    } catch (erro) {
      console.error('Erro ao carregar dados:', erro);
    }
  }

  carregarDados();
  setInterval(carregarDados, 60000); // Atualiza a cada 60s
</script>
	
</body>
</html>
